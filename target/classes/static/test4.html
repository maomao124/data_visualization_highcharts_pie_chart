<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>可变宽度的环形图</title>

    <script src="./js/highcharts.js"></script>
    <script src="./js/exporting.js"></script>
    <script src="./js/series-label.js"></script>
    <script src="./js/zh_cn.js"></script>
    <script src="https://code.hcharts.cn/highcharts/modules/variable-pie.js"></script>

</head>

<style>
    #container {
        width: 70vw;
        height: 70vh;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
</style>
<body>
<div id="container"></div>
<script>
    var chart = Highcharts.chart('container', {
        chart: {
            type: 'variablepie'
        },
        title: {
            text: '不同国家人口密度及面积对比'
        },
        subtitle: {
            text: '扇区长度（圆周方法）表示面积，宽度（纵向）表示人口密度'
        },
        tooltip: {
            headerFormat: '',
            pointFormat: '<span style="color:{point.color}">\u25CF</span> <b> {point.name}</b><br/>' +
                '面积 (平方千米): <b>{point.y}</b><br/>' +
                '人口密度 (每平方千米人数): <b>{point.z}</b><br/>'
        },
        series: [{
            minPointSize: 10,
            innerSize: '20%',
            zMin: 0,
            name: 'countries',
            data: [{
                name: '西班牙',
                y: 505370,
                z: 92.9
            }, {
                name: '法国',
                y: 551500,
                z: 118.7
            }, {
                name: '波兰',
                y: 312685,
                z: 124.6
            }, {
                name: '捷克共和国',
                y: 78867,
                z: 137.5
            }, {
                name: '意大利',
                y: 301340,
                z: 201.8
            }, {
                name: '瑞士',
                y: 41277,
                z: 214.5
            }, {
                name: '德国',
                y: 357022,
                z: 235.6
            }]
        }]
    })

    window.setInterval(() =>
    {
        var z1 = 92.9 + (Math.random() > 0.3 ? 26 : -12)
        var z2 = 118.7 + (Math.random() > 0.3 ? 28 : -13)
        var z3 = 124.6 + (Math.random() > 0.3 ? 19 : -12)
        var z4 = 137.5 + (Math.random() > 0.3 ? 28 : -12)
        var z5 = 201.8 + (Math.random() > 0.3 ? 39 : -16)
        var z6 = 214.5 + (Math.random() > 0.3 ? 32 : -14)
        var z7 = 235.6 + (Math.random() > 0.3 ? 20 : -10)

        var data = [{
            name: '西班牙',
            y: 505370,
            z: z1
        }, {
            name: '法国',
            y: 551500,
            z: z2
        }, {
            name: '波兰',
            y: 312685,
            z: z3
        }, {
            name: '捷克共和国',
            y: 78867,
            z: z4
        }, {
            name: '意大利',
            y: 301340,
            z: z5
        }, {
            name: '瑞士',
            y: 41277,
            z: z6
        }, {
            name: '德国',
            y: 357022,
            z: z7
        }]
        chart.series[0].updateData(data)
        chart.redraw();
    }, 2000)

</script>

</body>
</html>
